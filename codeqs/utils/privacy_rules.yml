rules:
  - id: insecure-transmission
    patterns:
      - pattern: requests.post(...)
      - pattern-not: '"https://"'
    message: "Personal data being transmitted over unsecured channel"
    severity: ERROR
    languages: [python]
    metadata:
      category: security
      compliance: GDPR, CCPA

  - id: sensitive-data-logging
    pattern: logging.info(..., $DATA)
    message: "Sensitive personal data being written to logs"
    severity: WARNING
    languages: [python]
    metadata:
      category: security
      compliance: GDPR, CCPA

  - id: missing-data-anonymization
    pattern: $DF.to_csv(...)
    message: "Potential export of PII without anonymization"
    severity: WARNING
    languages: [python]
    metadata:
      category: privacy
      compliance: GDPR

  - id: retention-policy-violation
    patterns:
      - pattern: archive(...)
      - pattern-not: retention_days
    message: "Data retention policy not enforced in code"
    severity: WARNING
    languages: [python]
    metadata:
      category: privacy
      compliance: GDPR, CCPA

  - id: missing-deletion-mechanism
    patterns:
      - pattern: delete_user_data(...)
      - pattern-not: confirm_deletion_request
    message: "Missing mechanism for data deletion on user request"
    severity: ERROR
    languages: [python]
    metadata:
      category: privacy
      compliance: GDPR, CCPA
